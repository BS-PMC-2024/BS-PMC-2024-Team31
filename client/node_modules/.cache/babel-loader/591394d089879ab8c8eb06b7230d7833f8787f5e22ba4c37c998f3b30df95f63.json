{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u05D0\\u05E1\\u05E8\\u05D0\\u05D0 \\u05D0\\u05DC\\u05D2\\u05E8\\u05D2\\u05D0\\u05D5\\u05D9\\\\OneDrive\\\\Desktop\\\\TIT\\\\client\\\\src\\\\components\\\\Edit\\\\EditProfile.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { useAuth } from '../../context/AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport './EditProfile.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst EditProfile = () => {\n  _s();\n  const {\n    token\n  } = useAuth();\n  const navigate = useNavigate();\n  const [profile, setProfile] = useState({\n    name: '',\n    email: '',\n    bio: '',\n    image: null\n  });\n  const [role, setRole] = useState(''); // Add state for role\n  const [error, setError] = useState('');\n  const handleChange = e => {\n    const {\n      name,\n      value,\n      files\n    } = e.target;\n    setProfile({\n      ...profile,\n      [name]: files ? files[0] : value\n    });\n  };\n  const handleRoleChange = async newRole => {\n    try {\n      const response = await fetch('/api/user/change-role', {\n        method: 'PUT',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          newRole\n        })\n      });\n      if (!response.ok) {\n        throw new Error('Failed to change role');\n      }\n      const updatedProfile = await response.json();\n      console.log('Role updated:', updatedProfile);\n      navigate('/profile'); // Redirect after changing role\n    } catch (error) {\n      console.error('Failed to change role:', error);\n      setError('Failed to change role');\n    }\n  };\n  const handleSave = async () => {\n    if (!profile.name || !profile.email || !profile.bio) {\n      setError('Please fill in all fields');\n      return;\n    }\n    const formData = new FormData();\n    formData.append('name', profile.name);\n    formData.append('email', profile.email);\n    formData.append('bio', profile.bio);\n    if (profile.image) {\n      formData.append('image', profile.image);\n    }\n    try {\n      const response = await fetch('/api/user/profile', {\n        method: 'PUT',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: formData\n      });\n      if (!response.ok) {\n        throw new Error('Failed to update profile');\n      }\n      const updatedProfile = await response.json();\n      console.log('Profile updated:', updatedProfile);\n      navigate('/profile'); // Redirect after saving\n    } catch (error) {\n      console.error('Failed to save profile:', error);\n      setError('Failed to save profile');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"edit-profile-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Edit Profile\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-msg\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Name:\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"name\",\n          value: profile.name,\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Email:\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          name: \"email\",\n          value: profile.email,\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Bio:\", /*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"bio\",\n          value: profile.bio,\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: [\"Profile Image:\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          name: \"image\",\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: handleSave,\n        children: \"Save Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"role-change-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Change Role\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => handleRoleChange('worker'),\n        children: \"Switch to Worker\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => handleRoleChange('student'),\n        children: \"Switch to Student\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n};\n_s(EditProfile, \"kNK/NEhvdBLbJWhrJYtj0792pAo=\", false, function () {\n  return [useAuth, useNavigate];\n});\n_c = EditProfile;\nexport default EditProfile;\nvar _c;\n$RefreshReg$(_c, \"EditProfile\");","map":{"version":3,"names":["React","useState","useAuth","useNavigate","jsxDEV","_jsxDEV","EditProfile","_s","token","navigate","profile","setProfile","name","email","bio","image","role","setRole","error","setError","handleChange","e","value","files","target","handleRoleChange","newRole","response","fetch","method","headers","body","JSON","stringify","ok","Error","updatedProfile","json","console","log","handleSave","formData","FormData","append","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","onChange","onClick","_c","$RefreshReg$"],"sources":["C:/Users/אסראא אלגרגאוי/OneDrive/Desktop/TIT/client/src/components/Edit/EditProfile.jsx"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './EditProfile.css';\r\n\r\nconst EditProfile = () => {\r\n  const { token } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [profile, setProfile] = useState({\r\n    name: '',\r\n    email: '',\r\n    bio: '',\r\n    image: null,\r\n  });\r\n  const [role, setRole] = useState(''); // Add state for role\r\n  const [error, setError] = useState('');\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value, files } = e.target;\r\n    setProfile({\r\n      ...profile,\r\n      [name]: files ? files[0] : value,\r\n    });\r\n  };\r\n\r\n  const handleRoleChange = async (newRole) => {\r\n    try {\r\n      const response = await fetch('/api/user/change-role', {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ newRole }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to change role');\r\n      }\r\n\r\n      const updatedProfile = await response.json();\r\n      console.log('Role updated:', updatedProfile);\r\n      navigate('/profile'); // Redirect after changing role\r\n    } catch (error) {\r\n      console.error('Failed to change role:', error);\r\n      setError('Failed to change role');\r\n    }\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!profile.name || !profile.email || !profile.bio) {\r\n      setError('Please fill in all fields');\r\n      return;\r\n    }\r\n\r\n    const formData = new FormData();\r\n    formData.append('name', profile.name);\r\n    formData.append('email', profile.email);\r\n    formData.append('bio', profile.bio);\r\n    if (profile.image) {\r\n      formData.append('image', profile.image);\r\n    }\r\n\r\n    try {\r\n      const response = await fetch('/api/user/profile', {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n        body: formData,\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Failed to update profile');\r\n      }\r\n\r\n      const updatedProfile = await response.json();\r\n      console.log('Profile updated:', updatedProfile);\r\n      navigate('/profile'); // Redirect after saving\r\n    } catch (error) {\r\n      console.error('Failed to save profile:', error);\r\n      setError('Failed to save profile');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"edit-profile-container\">\r\n      <h1>Edit Profile</h1>\r\n      {error && <div className=\"error-msg\">{error}</div>}\r\n      <form>\r\n        <label>\r\n          Name:\r\n          <input type=\"text\" name=\"name\" value={profile.name} onChange={handleChange} />\r\n        </label>\r\n        <label>\r\n          Email:\r\n          <input type=\"email\" name=\"email\" value={profile.email} onChange={handleChange} />\r\n        </label>\r\n        <label>\r\n          Bio:\r\n          <textarea name=\"bio\" value={profile.bio} onChange={handleChange}></textarea>\r\n        </label>\r\n        <label>\r\n          Profile Image:\r\n          <input type=\"file\" name=\"image\" onChange={handleChange} />\r\n        </label>\r\n        <button type=\"button\" onClick={handleSave}>Save Profile</button>\r\n      </form>\r\n      <div className=\"role-change-section\">\r\n        <h2>Change Role</h2>\r\n        <button onClick={() => handleRoleChange('worker')}>Switch to Worker</button>\r\n        <button onClick={() => handleRoleChange('student')}>Switch to Student</button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditProfile;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}